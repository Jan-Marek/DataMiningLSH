** Spoilers follow**
Image caption Anna Chancellor and Bill Nighy starred in the new adaptation
The BBC's three-part drama Ordeal by Innocence reached its jaw-dropping climax on Sunday.
The plot-twisting finale unveiled who was behind the brutal murder of Rachel Argyll (Anna Chancellor) - as well as the deaths of her adoptive son Jack (Anthony Boyle) and son-in-law Philip Durrant (Matthew Goode).
But some were unhappy with the way the adaptation differed from Agatha Christie's original storyline.
The identity of the culprit was changed and as a result the denouement of the entire storyline was altered.
While some enjoyed the new ending, not everyone was pleased about the update.
Image caption If you thought you knew who killed Rachel, think again...
How the ending changed from the original
Christie's original storyline had the housekeeper, Kirsten Lindstrom, as the architect of the deaths of Rachel and Philip.
Rather than being the mother of Jack, she was his lover, who stole money from Rachel and murdered her on his behest.
Jack, after being found with a wallet full of cash and no alibi, was convicted and died from pneumonia in prison six months later.
Image caption Philip and Mary Durrant in happier times
When Mary's brash wheelchair-bound husband, Philip, started asking too many questions, Kirsten killed him too by stabbing him in the back of the neck. His sister-in-law, Tina, heard a commotion and came running in, only to be stabbed as well - although she survived.
But in the latest BBC adaptation, it was Leo Argyll (Bill Nighy) in the drawing room with the Egyptian statuette.
Rachel's husband was revealed as a serial adulterer and rapist, killing the Argyll matriarch after she threatened him with divorce.
He went on to frame his own son, Jack - eventually ordering his murder in prison, when Jack swore to tell the truth about him at trial.
What Agatha Christie would make of it
The best-selling crime writer's great-grandson James Prichard told BBC News he'd had "sleepless nights" over changing the ending.
"We agonised long and hard over it, but we did allow it," he said. "We didn't do it lightly - or without understanding that a lot of people would be upset."
Prichard, who manages the rights to Christie's works, said it was clear Phelps was struggling to write Kirsten as the murderer.
Image caption Agatha Christie wrote more than sixty detective novels
"It was obvious that she wanted Leo to be the killer," he says. "She didn't admit it to me early on, but I got a feeling that that was at the back of her mind.
"I had a phone conversation with my father and he said, 'Why don't you just let it happen?'".
Prichard pointed out that Christie herself was not averse to reworking her novels for adaptations, adding: "She took Poirot out of most of the books that she adapted for theatre. She understood that sometimes you need to change things for different mediums.
"Every adaptation has changes. You cannot just directly translate a novel into a TV film or into a play."
What the screenwriter said
Sarah Phelps, who wrote the modern retelling of the classic murder mystery, admitted she had taken "liberties" with the story.
"I've taken some very clear and quite big liberties, with the story of the novel," Phelps told Digital Spy. "But I think I've represented the spirit of the novel.
"I wanted to write something that you think is familiar but it isn't."
Image caption Leo's confrontation with Jack in the final episode
The screenwriter, who has adapted a number of other Agatha Christie novels, said: "They've got to feel like they live, and they've got blood pulsing through their veins, and [like] they've got something to say."
Phelps admitted that some people would never accept the changes, adding that those people "don't want a story, they want the perfect rendition of their relationship to a particular piece of work".
What critics said
The Daily Mail said that changing the plot for television had "infuriated fans", with some seeing it as a "twist too far".
The paper also said that too much swearing in the adaptation had "added insult to injury" and that it "should have stayed true to the celebrated author's straight-laced tone".
However, The Daily Telegraph gave the series four stars describing the finale as "a real belter", while i News said it was "melodrama of the highest order".
Image caption Did Tina and Hester have anything to hide?
Writing for the newspaper, Rob Epstein said: "It was undoubtedly absorbing, with brisk pacing, every sentence and action imbued with meaning. Aesthetically, it was stunning, the colour palette gorgeously vibrant."
Heat magazine's Boyd Hilton called the finale "absolutely phenomenal", while TV critic Toby Earle said the final scene of Kirsten walking along the basement corridor, after meting out her revenge, was "one of the shots of the year".
What people made of it
The rewrite of the classic has had audiences divided. Some, including Elly Griffiths - author of the Dr Ruth Galloway mysteries, thought you couldn't improve on an original Agatha Christie whodunnit.
Skip Twitter post by @ellygriffiths I enjoyed #OrdealByInnocence as a visual spectacle but why mess with the plot? Christie was great at plots. Also - Iâ€™d been smugly boasting about knowing whodunnit and they didnâ€™t â€” Elly Griffiths (@ellygriffiths) April 16, 2018 Report
Skip Twitter post by @Doctor_Dave80 So some arrogant BBC writer thought they could do better than Agatha Christie? Why adapt something if youâ€™re going to change everything, even the killer?! Just write something new instead ðŸ™„ #OrdealByInnocence â€” Dave Johnson (@Doctor_Dave80) April 15, 2018 Report
But actress and YouTuber Tanya Burr was a fan of the changes, saying she wanted to tweet spoilers as soon as it finished so she could talk about the ending.
For what it's worth, James Prichard said he thought Ordeal by Innocence was a "fantastic piece of TV" - but Agatha Christie fans will be reassured to hear that "this is not the start of a road where we're setting about rewriting all her work".
Follow us on Facebook, on Twitter @BBCNewsEnts, or on Instagram at bbcnewsents. If you have a story suggestion email entertainment.news@bbc.co.uk.